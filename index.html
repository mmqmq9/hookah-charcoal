<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ÙØ­Ù… ÙŠÙˆÙ„Ø¯ ÙƒÙŠÙˆØ¨ â€” ØªØ¬Ø±Ø¨Ø© 3D Ù…Ø­Ø³Ù‘Ù†Ø©</title>
  <meta name="description" content="Ù†Ø³Ø®Ø© Ù…Ø­Ø³Ù‘Ù†Ø© Ù…Ù† Ø¹Ø±Ø¶ Ù…ÙƒØ¹Ø¨ Ø§Ù„ÙØ­Ù… Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ â€” Ø£Ø¯Ø§Ø¡ Ù…Ø­Ø³Ù†ØŒ ØªØ­Ù…ÙŠÙ„ ÙƒØ³ÙˆÙ„ØŒ Ø¨Ø¯ÙŠÙ„ CSS Ù„Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø¶Ø¹ÙŠÙØ©." />
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700;900&display=swap" rel="stylesheet">
  <style>
    :root{
      --orange:#ff5e00; --gold:#ffb74d; --dark:#0a0a0a; --glass: rgba(255,255,255,0.05);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;font-family:'Cairo',sans-serif;background:var(--dark);color:#fff;overflow-x:hidden}
    #three-container{position:fixed;inset:0;z-index:-1}
    .ui{position:absolute;top:20px;right:20px;z-index:60;text-align:right;pointer-events:none}
    .ui h1{font-size:20px;font-weight:900;background:linear-gradient(90deg,var(--orange),var(--gold));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .ui p{margin-top:6px;color:#ccc;font-size:13px}
    .cta{position:fixed;left:20px;bottom:20px;z-index:70}
    .cta a{display:inline-block;background:#25d366;color:#000;font-weight:800;padding:10px 16px;border-radius:40px;text-decoration:none;box-shadow:0 8px 24px rgba(0,0,0,0.4)}
    .content{position:relative;z-index:10;min-height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:2rem;text-align:center}
    .glass{background:var(--glass);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,0.08);border-radius:14px;padding:1.6rem;margin:1.6rem auto;max-width:900px;width:90%}
    header h1{font-size:2.6rem}
    header p{color:#ddd;font-size:1.05rem}
    .features{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:1rem;margin-top:1rem}
    .features div{padding:1rem;border-radius:10px;background:rgba(255,255,255,0.03)}
    footer{padding:2rem;color:#aaa}
    #loader{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:80;background:linear-gradient(180deg,rgba(0,0,0,0.55),transparent);transition:opacity .35s}
    #loader.hidden{opacity:0;pointer-events:none;visibility:hidden}
    .loader-inner{width:180px}
    .bar{height:8px;background:rgba(255,255,255,0.06);border-radius:6px;overflow:hidden}
    .bar > i{display:block;height:100%;width:0;background:linear-gradient(90deg,var(--orange),var(--gold));transition:width .25s}
    /* fallback css cube (visible for non-WebGL) */
    #fallback{display:none;position:fixed;inset:0;align-items:center;justify-content:center;background:#000;z-index:40}
    .css-scene{width:280px;height:280px;perspective:900px}
    .css-cube{width:100%;height:100%;position:relative;transform-style:preserve-3d;animation:spinFallback 12s linear infinite}
    .css-face{position:absolute;width:280px;height:280px;background:#111;border-radius:6px;border:3px solid rgba(255,94,0,0.12);box-shadow:inset 0 0 24px rgba(0,0,0,0.9)}
    .css-face.front{transform:translateZ(140px)}.css-face.back{transform:rotateY(180deg) translateZ(140px)}.css-face.right{transform:rotateY(90deg) translateZ(140px)}.css-face.left{transform:rotateY(-90deg) translateZ(140px)}.css-face.top{transform:rotateX(90deg) translateZ(140px)}.css-face.bottom{transform:rotateX(-90deg) translateZ(140px)}
    @keyframes spinFallback{from{transform:rotateX(0) rotateY(0)}to{transform:rotateX(360deg) rotateY(360deg)}}
    .scroll-animate{opacity:0;transform:translateY(40px);transition:all .8s ease}.scroll-animate.show{opacity:1;transform:translateY(0)}
    @media (max-width:768px){header h1{font-size:2rem}.css-scene{width:200px;height:200px}.css-face{width:200px;height:200px}}
  </style>
</head>
<body>
  <div id="three-container" aria-hidden="true"></div>

  <div id="fallback" role="img" aria-label="Ù…ÙƒØ¹Ø¨ ÙØ­Ù… ÙŠÙˆÙ„Ø¯ ÙƒÙŠÙˆØ¨ - Ø¨Ø¯ÙŠÙ„">
    <div class="css-scene">
      <div class="css-cube" aria-hidden="true">
        <div class="css-face front"></div>
        <div class="css-face back"></div>
        <div class="css-face right"></div>
        <div class="css-face left"></div>
        <div class="css-face top"></div>
        <div class="css-face bottom"></div>
      </div>
    </div>
  </div>

  <div class="ui">
    <h1>ÙØ­Ù… ÙŠÙˆÙ„Ø¯ ÙƒÙŠÙˆØ¨</h1>
    <p id="hint">Ø§Ù‚ØªØ±Ø¨ Ø¨Ø§Ù„Ù…Ø§ÙˆØ³ Ø£Ùˆ Ø§Ù„Ù…Ø³ Ø§Ù„Ø´Ø§Ø´Ø© Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ¹Ø§Ù„</p>
  </div>

  <div id="loader" role="status" aria-live="polite">
    <div class="loader-inner">
      <div style="margin-bottom:10px;text-align:center;color:#ddd;font-size:14px">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„ â€” ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div>
      <div class="bar" aria-hidden="true"><i id="loader-bar"></i></div>
    </div>
  </div>

  <div class="cta">
    <a id="wa" href="https://wa.me/966XXXXXXXXX" target="_blank" rel="noopener">ğŸ’¬ Ø§Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</a>
  </div>

  <main class="content">
    <header class="glass scroll-animate">
      <h1>ÙØ­Ù… ÙŠÙˆÙ„Ø¯ ÙƒÙŠÙˆØ¨</h1>
      <p>ÙØ­Ù… Ø·Ø¨ÙŠØ¹ÙŠ Ù…Ù† Ù‚Ø´ÙˆØ± Ø¬ÙˆØ² Ø§Ù„Ù‡Ù†Ø¯ â€” ÙŠØ¯ÙˆÙ… Ø­ØªÙ‰ 90 Ø¯Ù‚ÙŠÙ‚Ø© â€” Ø¹Ø¯ÙŠÙ… Ø§Ù„Ø±Ø§Ø¦Ø­Ø©.</p>
    </header>

    <section class="glass scroll-animate">
      <h2>Ù„Ù…Ø§Ø°Ø§ ÙŠÙˆÙ„Ø¯ ÙƒÙŠÙˆØ¨ØŸ</h2>
      <div class="features">
        <div>ğŸ•’ ÙŠØ¯ÙˆÙ… Ø­ØªÙ‰ 90 Ø¯Ù‚ÙŠÙ‚Ø©</div>
        <div>ğŸŒ´ Ù…Ù† Ù‚Ø´ÙˆØ± Ø¬ÙˆØ² Ø§Ù„Ù‡Ù†Ø¯</div>
        <div>ğŸ’¨ Ø¹Ø¯ÙŠÙ… Ø§Ù„Ø±Ø§Ø¦Ø­Ø© ÙˆØ§Ù„Ø¯Ø®Ø§Ù†</div>
        <div>ğŸ”² Ù…ÙƒØ¹Ø¨Ø§Øª Ø£Ù†ÙŠÙ‚Ø© ÙˆØ³Ù‡Ù„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</div>
      </div>
    </section>

    <section class="glass scroll-animate">
      <h2>Ø¢Ø±Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h2>
      <p>â Ø£ÙØ¶Ù„ ÙØ­Ù… Ø¬Ø±Ø¨ØªÙ‡! Ù„Ø§ ÙŠØªØ±Ùƒ Ø±Ø§Ø¦Ø­Ø© ÙˆÙŠØ´ØªØ¹Ù„ Ø¨Ø«Ø¨Ø§Øª. â â€“ Ø®Ø§Ù„Ø¯</p>
      <p>â Ø£Ù†ØµØ­ ÙÙŠÙ‡ Ø¨Ù‚ÙˆØ©ØŒ Ù…Ø«Ø§Ù„ÙŠ Ù„Ù„Ø´ÙŠØ´Ø© ÙˆØ§Ù„Ø¬Ù…Ø±Ø§Øª Ø§Ù„Ø·ÙˆÙŠÙ„Ø©. â â€“ Ø£Ø¨Ùˆ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡</p>
    </section>

    <footer class="scroll-animate">
      <p>Â© 2025 ÙØ­Ù… ÙŠÙˆÙ„Ø¯ ÙƒÙŠÙˆØ¨. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
    </footer>
  </main>

  <!-- ØªØ­Ù…ÙŠÙ„ Three.js Ø¨Ø´ÙƒÙ„ ÙƒØ³ÙˆÙ„ ÙˆØªØ­Ø³ÙŠÙ† Ø§Ù„ØªÙ‡ÙŠØ¦Ø© -->
  <script>
  (function(){
    'use strict';

    const loaderEl = document.getElementById('loader');
    const loaderBar = document.getElementById('loader-bar');
    const fallbackEl = document.getElementById('fallback');
    const threeContainer = document.getElementById('three-container');
    const hint = document.getElementById('hint');

    // ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø¯Ø§Ø¡: Ø§Ø¬Ø¹Ù„ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…Ø­Ù…ÙˆÙ„Ø© Ø£Ùˆ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØµØºÙŠØ± ØªØ¹ØªØ¨Ø± lowPower
    const forcedLow = new URLSearchParams(location.search).get('low') === '1';
    const lowPower = forcedLow || (/Android|iPhone|iPad|iPod/i.test(navigator.userAgent) || window.innerWidth < 900);

    // ÙØ­Øµ Ø¯Ø¹Ù… WebGL (Ø¢Ù…Ù†)
    function webglAvailable(){
      try{
        const canvas = document.createElement('canvas');
        return !!(window.WebGLRenderingContext && (canvas.getContext('webgl') || canvas.getContext('experimental-webgl')));
      }catch(e){ return false; }
    }

    // ØªØ³Ø§Ø¹Ø¯ Ø¹Ù„Ù‰ ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªØ­Ù…ÙŠÙ„
    function setProgress(p){
      loaderBar.style.width = Math.max(2, Math.min(100, Math.round(p*100))) + '%';
    }

    // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¨Ø¯ÙŠÙ„ Ø¨Ø³Ø±Ø¹Ø© Ø¨ÙŠÙ†Ù…Ø§ ÙŠØªÙ… ØªØ¬Ù‡ÙŠØ² WebGL
    fallbackEl.style.display = 'flex';

    // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† WebGL Ù…ØªØ§Ø­Ù‹Ø§ØŒ Ù†Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø¯ÙŠÙ„ ÙˆÙ†Ù†Ù‡ÙŠ
    if(!webglAvailable()){
      loaderEl.classList.add('hidden');
      hint.textContent = 'Ø¬Ù‡Ø§Ø²Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… WebGL â€” Ø¹Ø±Ø¶ Ø¨Ø¯ÙŠÙ„ Ù‚ÙŠØ¯ Ø§Ù„ØªØ´ØºÙŠÙ„';
      return;
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙƒØ±Ø¨ØªØ§Øª Ø¨Ø´ÙƒÙ„ ÙƒØ³ÙˆÙ„ (deferred) Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… requestIdleCallback Ø¥Ù† ØªÙˆØ§Ø¬Ø¯
    function loadScript(src, attrs = {}) {
      return new Promise((resolve, reject) => {
        const s = document.createElement('script');
        s.src = src;
        s.async = true;
        Object.keys(attrs).forEach(k => s.setAttribute(k, attrs[k]));
        s.onload = () => resolve();
        s.onerror = () => reject(new Error('Failed to load ' + src));
        document.head.appendChild(s);
      });
    }

    // Ù†Ø³Ù‚ Ø§Ù„ØªØ­Ø³ÙŠÙ†: Ø¶Ø¨Ø· Ù†Ø³Ø¨Ø© Ø§Ù„Ø¨ÙŠÙƒØ³Ù„ - ØªÙ‚Ù„Ù„ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ GPU
    function getPixelRatio(){
      const dpr = window.devicePixelRatio || 1;
      if(lowPower) return Math.min(1, dpr);
      return Math.min(1.5, dpr);
    }

    // ØªØ­Ù…ÙŠÙ„ Ù…ÙƒØªØ¨Ø© Three.js Ø«Ù… ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø´Ù‡Ø¯. Ù†Ø³ØªØ®Ø¯Ù… requestIdleCallback Ø¥Ù† ØªÙˆÙØ±.
    const threeCDN = 'https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js';
    const extrasBase = 'https://cdn.jsdelivr.net/npm/three@0.160.0/examples/js/';

    const scriptsToLoad = [
      threeCDN,
      extrasBase + 'postprocessing/EffectComposer.js',
      extrasBase + 'postprocessing/RenderPass.js',
      extrasBase + 'postprocessing/UnrealBloomPass.js',
      extrasBase + 'controls/OrbitControls.js'
    ];

    // ØªØ­Ù…ÙŠÙ„ ØªØ¯Ø±ÙŠØ¬ÙŠ ÙˆØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø®Ø·Ø£
    (window.requestIdleCallback || function(fn){ return setTimeout(fn, 200); })(async () => {
      try {
        // Load scripts sequentially to avoid race conditions on older browsers
        for(let i=0;i<scriptsToLoad.length;i++){
          await loadScript(scriptsToLoad[i]);
          setProgress((i+1) / scriptsToLoad.length * 0.7); // up to 70% for script loads
        }
        setProgress(0.75);

        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø´Ù‡Ø¯ Ø¨Ø£Ù…Ø§Ù† Ø¯Ø§Ø®Ù„ idle callback
        initThree();
      } catch (err) {
        console.error('Error loading 3D assets:', err);
        hint.textContent = 'ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø±Ø³ÙˆÙ… â€” Ø¹Ø±Ø¶ Ø¨Ø¯ÙŠÙ„ Ù‚ÙŠØ¯ Ø§Ù„ØªØ´ØºÙŠÙ„';
        loaderEl.classList.add('hidden');
        fallbackEl.style.display = 'flex';
      }
    });

    // Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„ØªÙ‡ÙŠØ¦Ø© Three.js (Ù…Ø¨Ø³Ø·Ø© ÙˆÙ…Ø­ÙˆÙ‘Ù„Ø© Ù„Ù„Ø£Ø¯Ø§Ø¡)
    function initThree(){
      // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¨Ø¯ÙŠÙ„ Ø¨Ø¹Ø¯ Ø¬Ø§Ù‡Ø²ÙŠØ© WebGL
      fallbackEl.style.display = 'none';

      // ØªØ£Ø®ÙŠØ± Ø¹Ø±Ø¶ Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø«Ù‚ÙŠÙ„Ø© Ù„Ø¨Ø¶Ø¹ Ø¥Ø·Ø§Ø± Ù„ØªØ³Ù‡ÙŠÙ„ ØªÙØ§Ø¹Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
      setTimeout(() => {
        try{
          const THREE = window.THREE;
          const scene = new THREE.Scene();
          scene.fog = new THREE.FogExp2(0x000000, 0.02);

          const camera = new THREE.PerspectiveCamera(45, innerWidth/innerHeight, 0.1, 100);
          camera.position.set(0, 1.6, 6);

          const renderer = new THREE.WebGLRenderer({ alpha:true, antialias: !lowPower, powerPreference: lowPower ? 'low-power' : 'high-performance' });
          renderer.setPixelRatio(getPixelRatio());
          renderer.setSize(innerWidth, innerHeight);
          renderer.outputEncoding = THREE.sRGBEncoding;
          threeContainer.appendChild(renderer.domElement);

          // Ø£Ø³Ø±Ø¹ Ø¥Ø¶Ø§ÙØ© Ø£Ø¶Ø§Ø¡Ø© Ø¨Ø³ÙŠØ·Ø©
          scene.add(new THREE.AmbientLight(0xffffff, 0.12));
          const fireLight = new THREE.PointLight(0xff7a33, 1.0, 12, 2);
          fireLight.position.set(0,1.2,1.5);
          scene.add(fireLight);

          // Ø£Ø±Ø¶ÙŠØ© Ø¨Ø³ÙŠØ·Ø©
          const plane = new THREE.Mesh(new THREE.PlaneGeometry(40,40), new THREE.MeshStandardMaterial({color:0x050505, roughness:1}));
          plane.rotation.x = -Math.PI/2;
          plane.position.y = -1.6;
          scene.add(plane);

          // Ù…ÙƒØ¹Ø¨ Ø§Ù„ÙØ­Ù… â€” ØªÙ‚Ø³ÙŠÙ… Ø£Ù‚Ù„ Ù„Ù„Ø£Ø¯Ø§Ø¡
          const cubeGeom = new THREE.BoxGeometry(2.2,2.2,2.2, 8,8,8);
          const txLoader = new THREE.TextureLoader();
          // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª noise ØµØºÙŠØ±Ø© Ù…Ø¶Ù…Ù‘Ù†Ø©
          const noiseDataURL = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width=\"64\" height=\"64\"><filter id=\"n\"><feTurbulence baseFrequency=\"0.9\" numOctaves=\"1\" stitchTiles=\"stitch\"/></filter><rect width=\"100%\" height=\"100%\" filter=\"url(%23n)\"/></svg>';
          const rough = txLoader.load(noiseDataURL);
          rough.wrapS = rough.wrapT = THREE.RepeatWrapping;
          rough.repeat.set(3,3);

          const cubeMat = new THREE.MeshPhysicalMaterial({
            color:0x0b0b0b, metalness:0.15, roughness:0.85, emissive:0x220000, emissiveIntensity:0.12, roughnessMap:rough
          });
          const cube = new THREE.Mesh(cubeGeom, cubeMat);
          cube.position.y = 0.0;
          scene.add(cube);

          // inner ember (Ø®ÙÙŠÙ)
          const innerGeom = new THREE.BoxGeometry(1.4,1.4,1.4);
          const innerMat = new THREE.MeshBasicMaterial({color:0xff4500, transparent:true, opacity:0});
          const inner = new THREE.Mesh(innerGeom, innerMat);
          scene.add(inner);

          // Ø°Ø±Ø§Øª ember â€” Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¹Ø¯Ø¯ Ø£Ù‚Ù„ Ù„Ù„Ø£Ø¯Ø§Ø¡
          const emberCount = lowPower ? 60 : 120;
          const emberGeo = new THREE.BufferGeometry();
          const emberPos = new Float32Array(emberCount*3);
          const emberCol = new Float32Array(emberCount*3);
          for(let i=0;i<emberCount;i++){
            emberPos[i*3+0] = (Math.random()-0.5)*1.1;
            emberPos[i*3+1] = (Math.random()-0.5)*1.1;
            emberPos[i*3+2] = (Math.random()-0.5)*1.1;
            emberCol[i*3+0] = 1.0;
            emberCol[i*3+1] = 0.4 + Math.random()*0.6;
            emberCol[i*3+2] = 0.0;
          }
          emberGeo.setAttribute('position', new THREE.BufferAttribute(emberPos, 3));
          emberGeo.setAttribute('color', new THREE.BufferAttribute(emberCol, 3));
          const emberMat = new THREE.PointsMaterial({size: lowPower ? 0.04 : 0.06, vertexColors:true, transparent:true, opacity:0.9, blending:THREE.AdditiveBlending});
          const embers = new THREE.Points(emberGeo, emberMat);
          scene.add(embers);

          // Ø§Ø­ÙØ¸ composer ÙÙ‚Ø· Ø¥Ù† Ø§Ù„Ø¬Ù‡Ø§Ø² Ù‚ÙˆÙŠ Ø¨Ù…Ø§ ÙŠÙƒÙÙŠ
          let composer = null, controls = null;
          if(!lowPower && THREE.EffectComposer){
            composer = new THREE.EffectComposer(renderer);
            composer.addPass(new THREE.RenderPass(scene, camera));
            const bloom = new THREE.UnrealBloomPass(new THREE.Vector2(innerWidth, innerHeight), 0.9, 0.6, 0.1);
            bloom.threshold = 0.12; bloom.strength = 1.0; bloom.radius = 0.5;
            composer.addPass(bloom);
          }

          // Ø¶ÙˆØ§Ø¨Ø· Ø®ÙÙŠÙØ©
          controls = new THREE.OrbitControls(camera, renderer.domElement);
          controls.enablePan = false; controls.enableZoom = false; controls.enableDamping = true; controls.dampingFactor = 0.06; controls.maxPolarAngle = Math.PI/2.2;

          // ØªØ¹Ø§Ù…Ù„ Ø§Ù„ØªÙØ§Ø¹Ù„
          let isHover = false;
          let pointer = {nx:0, ny:0};

          function onPointerMove(e){
            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            const clientY = e.touches ? e.touches[0].clientY : e.clientY;
            pointer.nx = (clientX / innerWidth) * 2 - 1;
            pointer.ny = (clientY / innerHeight) * 2 - 1;
          }
          window.addEventListener('pointermove', onPointerMove, {passive:true});
          window.addEventListener('touchmove', onPointerMove, {passive:true});

          renderer.domElement.addEventListener('pointerenter', () => { isHover=true; hint.textContent='Ø§Ù„Ø¢Ù† ÙŠØ´ØªØ¹Ù„ â€” Ø§Ø³Ø­Ø¨ Ø£Ùˆ Ø­Ø±Ùƒ Ø§Ù„Ù…Ø§ÙˆØ³'; }, {passive:true});
          renderer.domElement.addEventListener('pointerleave', () => { isHover=false; hint.textContent='Ø§Ù‚ØªØ±Ø¨ Ø¨Ø§Ù„Ù…Ø§ÙˆØ³ Ø£Ùˆ Ø§Ù„Ù…Ø³ Ø§Ù„Ø´Ø§Ø´Ø©'; }, {passive:true});
          renderer.domElement.addEventListener('touchstart', () => { isHover=true; }, {passive:true});
          renderer.domElement.addEventListener('touchend', () => { isHover=false; }, {passive:true});

          // Ø­Ù„Ù‚Ø© Ø§Ù„Ø±Ø³ÙˆÙ… - Ù…Ø¹ Ù‚ÙŠÙˆØ¯ Ø§Ù„Ø£Ø¯Ø§Ø¡
          const clock = new THREE.Clock();
          function animate(){
            const t = clock.getElapsedTime();

            // ØªØ¯ÙˆÙŠØ± Ø®ÙÙŠÙ Ù…ØªØ£Ø«Ø± Ø¨Ø§Ù„Ù…Ø¤Ø´Ø±
            const targetRX = (pointer.ny || 0) * 0.35;
            const targetRY = (pointer.nx || 0) * 0.5;
            cube.rotation.x += (targetRX - cube.rotation.x) * 0.06;
            cube.rotation.y += (targetRY - cube.rotation.y) * 0.06;

            // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø§Ø´ØªØ¹Ø§Ù„
            const baseEm = 0.12;
            const boost = isHover ? 0.9 : 0;
            cube.material.emissiveIntensity = baseEm + boost * (0.5 + Math.abs(Math.sin(t*6))*0.6);
            inner.material.opacity = Math.min(0.9, boost * (0.25 + Math.abs(Math.sin(t*8))*0.75));

            // Ø­Ø±ÙƒØ© Ø¨Ø³ÙŠØ·Ø© Ù„Ù„Ø¬Ù…Ø±Ø§Øª
            const pos = emberGeo.attributes.position;
            for(let i=0;i<emberCount;i++){
              const idx = i*3+1;
              pos.array[idx] += 0.001 + (Math.sin(t*3 + i) * 0.0006);
              if(pos.array[idx] > 1.2) pos.array[idx] = -0.6 + Math.random()*0.2;
            }
            pos.needsUpdate = true;

            // ØªØ°Ø¨Ø°Ø¨ Ø§Ù„Ø¶ÙˆØ¡
            fireLight.intensity = 0.8 + (isHover ? 1.4 : 0.35) * (0.6 + Math.abs(Math.sin(t*10))*0.8);
            fireLight.color.setHSL(0.06, 1, Math.min(1, 0.45 + fireLight.intensity*0.12));

            // render
            if(composer){
              composer.render();
            } else {
              renderer.render(scene, camera);
            }
            controls.update();
            requestAnimationFrame(animate);
          }

          // Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØµÙØ­Ø©
          setProgress(0.95);
          setTimeout(()=>{ loaderEl.classList.add('hidden'); setProgress(1); }, 220);

          // Ø§Ø³ØªÙ…Ø§Ø¹ Ù„ØªØºÙŠØ± Ø§Ù„Ø­Ø¬Ù…
          window.addEventListener('resize', ()=> {
            camera.aspect = innerWidth/innerHeight; camera.updateProjectionMatrix();
            renderer.setSize(innerWidth, innerHeight);
            if(composer && composer.setSize) composer.setSize(innerWidth, innerHeight);
          }, {passive:true});

          // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø¹Ù„Ù‰ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø­ØªÙˆÙ‰
          const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => { if(entry.isIntersecting) entry.target.classList.add('show'); });
          }, {threshold:0.12});
          document.querySelectorAll('.scroll-animate').forEach(el => observer.observe(el));

          // Ø¨Ø¯Ø¡ Ø§Ù„Ø­Ù„Ù‚Ø©
          animate();

        } catch(e){
          console.error('Initialization error:', e);
          loaderEl.classList.add('hidden');
          fallbackEl.style.display = 'flex';
          hint.textContent = 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø´Ù‡Ø¯ â€” Ø¹Ø±Ø¶ Ø¨Ø¯ÙŠÙ„ Ù‚ÙŠØ¯ Ø§Ù„ØªØ´ØºÙŠÙ„';
        }
      }, 60);
    }

  })();
  </script>
</body>
</html>